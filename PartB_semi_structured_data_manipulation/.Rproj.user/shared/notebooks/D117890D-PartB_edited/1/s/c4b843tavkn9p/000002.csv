"0","# Get total number of missing values for each country and each product across years"
"0","a = aggregate(value ~ country + product, data=FINAL_structural_data, function(x) {sum(is.na(x))}, na.action = NULL)"
"0",""
"0","# Get total number of records for each country and each product across years"
"0","b = FINAL_structural_data %>%"
"0","  group_by(country, product) %>%"
"0","  summarise(n = n())"
"2","`summarise()` regrouping output by 'country' (override with `.groups` argument)
"
"0","# Inner join the two data frame above to check if the number of records equals to the number of missing values under the same country and the same product"
"0","c = merge(a, b, by = c(""product"", ""country""), all = T)"
"0",""
"0","# If number of missing value equals to number of records, then all records for a particular product in this country are missing (across years and flows) "
"0","d = c[which(c$value == c$n), c(""country"", ""product"")]"
"0",""
"0","# Remove records if there is no non-NA value across the whole period and flows for each product and each country"
"0","FINAL_DATA_NA_REMOVE = FINAL_structural_data"
"0","for (i in 1:nrow(d)){"
"0","  FINAL_DATA_NA_REMOVE = FINAL_DATA_NA_REMOVE %>%"
"0","    filter(country != d[i,1] | product != d[i,2])"
"0","}"
"0",""
"0","# Convert the rest of missing values into 0"
"0","FINAL_DATA_NA_REMOVE[is.na(FINAL_DATA_NA_REMOVE)] = 0"
