"0","DataFormation = function(file_path){"
"0","  data = read_excel(file_path)"
"0","  "
"0","  # Remove column 2 since it doesn't contain any values"
"0","  data[,2] = NULL"
"0","  "
"0","  # The name of the flow is stored in the second row of column ...3"
"0","  Flow = data$...3[2]"
"0","  "
"0","  # The name of the country is stored in the fourth row of column ...3"
"0","  Country = data$...3[4]"
"0","  "
"0","  # Filter rows to only keep product and year information"
"0","  data = data %>%"
"0","    filter(...1 %in% c(""Product"", 1960:2013)) "
"0","  "
"0","  # Replace "".."" values with NA"
"0","  data[data == ""..""] = NA"
"0","  "
"0","  # Rename the original columns and add two more columns - country and flow "
"0","  data = data %>%"
"0","    row_to_names(row_number = 1) %>%"
"0","    rename(year = Product) %>%"
"0","    mutate(country = Country, flow = Flow)"
"0","  "
"0","  # Start gathering (pivoting data longer)"
"0","  structured_data = data %>%"
"0","    gather(key = ""product"", "
"0","           value = ""value"", "
"0","           -c(""country"", ""year"", ""flow"")) %>%"
"0","    arrange(year) %>%                             "
"0","    select(country, year, flow, product, value)   # Reorder the order of columns"
"0","  "
"0","  structured_data$value = as.numeric(structured_data$value)"
"0","  "
"0","  return(structured_data)"
"0","}"
